var B=Object.defineProperty;var D=(t,e,s)=>e in t?B(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var g=(t,e,s)=>(D(t,typeof e!="symbol"?e+"":e,s),s);import"../../modulepreload-polyfill-3cfb730f.js";/* empty css                  */import{p as v}from"../../p5.min-9f376f7a.js";import{P as Y}from"../../particle-e1d0c5bf.js";import{t as F}from"../../tweakpane-5ac9913a.js";import{m as O}from"../../canvas-images-ccb14e3e.js";import"../../_commonjsHelpers-725317a4.js";import"../../_commonjs-dynamic-modules-302442b1.js";import"../../utils-a26ac38d.js";const G=(t,e=.1)=>{let s=t.copy().magSq()*e,m=t.copy();return m.mult(-.5).normalize().mult(s),m};class H{constructor(e,s,m,p,d=.1){g(this,"left");g(this,"right");g(this,"top");g(this,"bottom");g(this,"center");g(this,"cd");this.center=new v.Vector(e,s),this.left=e-m/2,this.right=e+m/2,this.bottom=s+p/2,this.top=s-p/2,this.cd=d}set width(e){this.left=this.center.x-e/2,this.right=this.center.x+e/2}set height(e){this.bottom=this.center.y+e/2,this.top=this.center.y-e/2}set size(e){this.width=e,this.height=e}contains(e){return e.x>this.left&&e.x<this.right&&e.y>this.top&&e.y<this.bottom}draw(e){e.rect(this.left,this.top,this.right-this.left,this.bottom-this.top)}}function L(t,e,s,m,p){let d=new F.Pane;const c=()=>{p(),e.loop()};d.addInput(t,"gravityConstant",{min:.1,max:3,step:.1}),d.addInput(t,"alpha",{min:0,max:1,step:.01}),d.addInput(t,"weight",{min:0,max:10,step:.1});let l=d.addFolder({title:"particles grid"});l.addInput(t.particles,"type",{options:{random:"random",grid:"grid"}}).on("change",z);function z(){X.forEach(y=>{y.hidden=t.particles.type==="random"}),k.forEach(y=>{y.hidden=t.particles.type==="grid"})}let x={1:"1","-1":"-1",0:"0",random:"random"},k=[l.addInput(t.particles,"nRandom",{min:0,max:100,step:1}),l.addInput(t.particles,"initVelX",{options:x}),l.addInput(t.particles,"initVelY",{options:x})],X=[l.addInput(t.particles,"initVelX",{options:s}),l.addInput(t.particles,"initVelY",{options:s}),l.addInput(t.particles,"nx",{min:0,max:100,step:1}),l.addInput(t.particles,"ny",{min:0,max:100,step:1}),l.addInput(t.particles,"gridXMin",{min:0,max:1,step:.05}),l.addInput(t.particles,"gridXMax",{min:0,max:1,step:.05}),l.addInput(t.particles,"gridYMin",{min:0,max:1,step:.05}),l.addInput(t.particles,"gridYMax",{min:0,max:1,step:.05})],h=d.addFolder({title:"attractor 1"});h.addInput(t.a1,"mass",{min:1,max:100,step:1}),h.addInput(t.a1,"pos",{x:{min:0,max:1,step:.01},y:{min:0,max:1,step:.01}}),h.addInput(t.a1,"enable");let u=d.addFolder({title:"attractor 2"});return u.addInput(t.a2,"mass",{min:1,max:100,step:1}),u.addInput(t.a2,"pos",{x:{min:0,max:1,step:.01},y:{min:0,max:1,step:.01}}),u.addInput(t.a2,"enable"),l.on("change",c),h.on("change",c),u.on("change",c),d.addButton({title:"add 5 random particles"}).on("click",()=>m(5,!1)),d.addButton({title:"restart"}).on("click",c),z(),d}const a={a1:{mass:15,pos:{x:.5,y:.5},enable:!0},a2:{mass:10,pos:{x:.2,y:.3},enable:!1},particles:{type:"grid",nRandom:10,nx:8,ny:5,gridXMin:.1,gridXMax:.6,gridYMin:.9,gridYMax:1,initVelX:"-1",initVelY:"-1"},gravityConstant:1.5,size:400,nBoxes:0,boxDrag:.05,boxSize:.25,aConstrainMin:5,aConstrainMax:25,weightH:1.5,weight:1,alpha:.2,alphaH:.8};new v(t=>{let e=[],s=t.createGraphics(600,600),m=[],p=[],d=!1,c=new v.Vector(0,0),l={"-1":()=>-1,1:()=>1,0:()=>0,random:()=>t.random(-1,1),"map -1 to 1":(i,n)=>t.map(i,0,n-1,-1,1),"map -0.5 to 0.5":(i,n)=>t.map(i,0,n-1,-.5,.5),"map 0 to 1":(i,n)=>t.map(i,0,n-1,0,1),"map -1 to 0":(i,n)=>t.map(i,0,n-1,-1,0),"map 1 to -1":(i,n)=>t.map(i,0,n-1,1,-1),"map 0.5 to -0.5":(i,n)=>t.map(i,0,n-1,.5,-.5)},x=L(a,t,{"-1":"-1",1:"1",0:"0",random:"random","map -1 to 1":"map -1 to 1","map -0.5 to 0.5":"map -0.5 to 0.5","map 0 to 1":"map 0 to 1","map -1 to 0":"map -1 to 0","map 1 to -1":"map 1 to -1","map 0.5 to -0.5":"map 0.5 to -0.5"},h,k);function k(){X(),a.particles.type==="grid"?y():h(),E(),s&&s.remove(),s=t.createGraphics(t.width,t.height),s.colorMode(t.HSL),c.set(t.width/2-a.size/2,t.height/2-a.size/2)}function X(){m=[];for(let i=0;i<a.nBoxes;i++){let n=t.random(t.width),o=t.random(t.height);m.push(new H(n,o,t.width*.25,t.height*.25,a.boxDrag))}}function h(i=a.particles.nRandom,n=!0){n&&(e=[]);for(let o=0;o<i;o++){let r=1;e.push({particle:new Y(t.random(a.size),t.random(a.size),{radius:r*8,mass:r,velInit:new v.Vector(l[a.particles.initVelX](),l[a.particles.initVelY]())}),highlight:!1})}}function u(i,n){let o=[2,2];return i===o[0]&&n===o[1]||i===o[1]&&n===o[0]}function y(){e=[];let i=a.particles.nx,n=a.particles.ny;for(let o=0;o<i;o++)for(let r=0;r<n;r++){let I=1,V=t.map(o,0,i-1,a.particles.gridXMin,a.particles.gridXMax)*a.size;i===1&&(V=t.map(.5,0,1,a.particles.gridXMin,a.particles.gridXMax)*a.size);let b=t.map(r,0,n-1,a.particles.gridYMin,a.particles.gridYMax)*a.size;n===1&&(b=t.map(.5,0,1,a.particles.gridYMin,a.particles.gridYMax)*a.size);let f=u(o,r),w=new Y(V,b,{radius:I*8,mass:I,velInit:new v.Vector(l[a.particles.initVelX](o,i),l[a.particles.initVelY](r,n))});e.push({particle:w,highlight:f})}}function E(){p=[],a.a1.enable&&p.push(C(a.a1.pos.x,a.a1.pos.y,a.a1.mass)),a.a2.enable&&p.push(C(a.a2.pos.x,a.a2.pos.y,a.a2.mass))}function C(i,n,o=10){i=i*a.size,n=n*a.size;let r=new Y(i,n,{mass:o,radius:40});return r.constraint={min:a.aConstrainMin,max:a.aConstrainMax},r}t.setup=()=>{let i=t.createCanvas(600,600);t.angleMode(t.RADIANS),k(),O(i.elt),x.addButton({title:"save canvas"}).on("click",()=>t.saveCanvas(i)),x.addButton({title:"save image (only overlay)"}).on("click",()=>{d=!0})},t.draw=()=>{if(t.background(10),d){t.image(s,0,0),t.noLoop(),s.noLoop(),t.saveCanvas("image","jpg"),d=!1;return}t.push(),s.push(),t.translate(c),s.translate(c),t.stroke(100,100),t.strokeWeight(2),t.fill(50,100),p.forEach(n=>n.draw(t)),t.fill(200,100),t.noStroke(),s.strokeWeight(.5),m.forEach(n=>{t.fill(200,t.map(n.cd,.005,.08,0,100)),n.draw(t)});const i=(n=!0)=>{e.forEach(o=>{let r=o.particle,I=r.copy();p.forEach(f=>{let w=f.attract(r,a.gravityConstant);r.applyForce(w.mult(r.mass))}),m.forEach(f=>{if(f.contains(r)){let w=G(r.velocity,f.cd);r.applyForce(w)}}),r.update(),n&&r.draw(t);let V=r.velocity.mag();s.strokeWeight(a.weight);let b=t.map(V,0,4,200,300);s.stroke(b,50,50,a.alpha),s.line(I.x,I.y,r.x,r.y)})};i(!1),i(!1),i(),s.pop(),t.pop(),t.image(s,0,0)}});
